
---
title: "DATA101 Week2"
author: "Abdirisak Mohamed"
date: "Spring 2018"
output:
  html_document:
    toc: yes
    toc_depth: '2'
  pdf_document:
    keep_tex: yes
    toc: yes
    toc_depth: 2
geometry: right=2.5in
---

```{r cache=FALSE, echo=FALSE}
library(knitr)
opts_chunk$set(fig.align="center", fig.height=5.5, fig.width=6, collapse=TRUE, comment="", prompt=TRUE)
options(width=63)
```

## Reproducibility

The following is taken from the book:
[Elements of Data Analytic Style](http://worldpece.org/sites/default/files/datastyle.pdf)

1. Reproducibility involves being able to recalculate the exact
   numbers in a data analysis using the code and raw data
   provided by the analyst.
   
2. Reproducibility is often difficult to achieve and has slowed down
    the discovery of important data analytic errors¹. 
    
3. Reproducibility should not be confused with
   “correctness” of a data analysis. A data analysis can be fully
   reproducible and recreate all numbers in an analysis and still
   be misleading or incorrect.

## Data Analysis Script
   
1. The primary way to ensure an analysis is reproducible is
   to create code scripts that exactly generate all numbers and
  figures in an analysis.

2. R markdown² and iPython notebooks³
   are both useful for organizing scripts. These tools integrate
   code, plain text, and figures into one document and are
examples of what is called, “literate programming”. 

3. An R markdown document includes text, code, and figures and can
  easily be converted into pdf or HTML format 
  
## Record Versions of Software and Parameters  

- In R you can get this information with the sessionInfo() command
  or the devtools::session_info() command, which is more informative.

## Organize Your Data Analysis

 - Data
    - raw data
    - processed data
 - Figures
    – Exploratory figures
    – Final figures
 - R code
     – Raw or unused scripts
     – Data processing scripts
 – Analysis scripts
    - Text
    – README files explaining what all the components are
    – Final data analysis products like presentations/writeups

## Use Version Control

- One very popular approach is to use Github⁶. You can put your R scripts,
  R markdown documents, and small data sets on Github, then
  use the version control system Git to manage your analysis.
  
## Set a Seed

- When your calculations involve random sampling - for example
  if you use the bootstrap or permutations - then you
  need to set a random number seed.
  
- This will ensure that the pseudorandom numbers generated by the computer will
  always be the same when different people run your analysis.
  
- In R you can do this with the command set.seed(13323)
  where 13323 can be replaced with any positive integer.
  
## Have Someone Else Run Your Analysis

- The best way to check reproducibility is to have someone else,
  ideally on a different type of computer, run your data analysis
  scripts.
  
- They should be able to run the analysis and get the
  same figures and results without having to ask you questions.

## Common Mistakes

- Not using a script for your analysis
- Not recording version numbers or parameters used
- Not sharing data or code
- Using reproducibility as a weapon

## Replicability

[Reproducible research can still be wrong: Adopting a prevention approach](http://www.pnas.org/content/112/6/1645.full#ref-1)

The replicability of a study is the chance that an independent experiment targeting the same scientific question will produce a consistent result 





# R Markdown Document

You can access the Cheatsheet: Help->Cheatsheets->R Markdown Cheatsheet


## R Markdown Files

- The  file contains three types of content:

    - An (optional) YAML header surrounded by ```---```s
    - R code chunks surrounded by ``` ``` ```s
    - text mixed with simple text formatting
 
 
```
---
title: "My First Project"
author: "Your Name"
date: January 30, 2018
output:
  pdf_document:
    toc: true
    toc_depth: 2
    keep_tex: true
geometry: right=2.5in
---
```

For more documentation:  <http://rmarkdown.rstudio.com> 

## Markdown

Headers:
```
# Header 1
## Header 2
### Header 3
```

Emphasis:
```
*italic* **bold**
_italic_ __bold__
```

Tables:
```
First Header  | Second Header
------------- | -------------
Content Cell  | Content Cell
Content Cell  | Content Cell
```


Unordered list:
```
- Item 1
- Item 2
    - Item 2a
    - Item 2b
```

Ordered list:
```
1. Item 1
2. Item 2
3. Item 3
    - Item 3a
    - Item 3b
```



Links:
```
http://example.com

[linked phrase](http://example.com)
```
[Authoring Basics](http://rmarkdown.rstudio.com/authoring_basics.html)



# Control Structures

Taken from *R Programming for Data Science*

## Purpose

- Control structures in R allow you to control the flow of execution of a series of R expressions

- Control structures allow you to put some logic into your R code, rather than just always executing the same R code every time

- Control structures allow you to respond to inputs or to features
  of the data and execute different R expressions accordingly.



## Common Control Structures

- `if` and `else`: testing a condition and acting on it
- `for`: execute a loop a fixed number of times
- `while`: execute a loop while a condition is true
- `repeat`: execute an infinite loop (must break out of it to stop)
- `break`: break the execution of a loop
- `next`: skip an interation of a loop



## Conditions

Evaluated conditions result in logical `TRUE` or `FALSE`.


Comparing numbers:

- `x == y` : TRUE if x equals y; otherwise FALSE
- `x > y` : TRUE if x is greater than y
- `x >= y` : TRUE if x is greater or equal y

Logical connectives

- `x && y` : TRUE if both x and y are TRUE
- `x || y` : TRUE if either x or y is TRUE
- `!x`: TRUE if x is FALSE


R functions 

- `is.na`

- `is.vector` 


## `if-else`

You can just use the if statement

```
if(<condition>) {
        ## do something
} 
## Continue with rest of code
```
The above code does nothing if the condition is false. 
If you have an action you want to execute
when the condition is false, then you need an `else` clause.

```
if(<condition>) {
        ## do something
} 
else {
        ## do something else
}
```

You can have a series of tests by following the initial `if` with any number of `else if`s.
```
if(<condition1>) {
       ## do something
} else if(<condition2>) {
       ## do something different
} else {
      ## do something different
}
```

```{r}
## Generate a uniform random number
x <- runif(1, 0, 10)
if(x > 3) {
y <- 10
} else {
y <- 0
}
```

## `for` Loops

Example:

```{r}
for(i in 1:10) {
  print(i)
}
```

## `for` Loops (cont'd)

Examples:

```{r}
x <- c("a", "b", "c", "d")

for(i in 1:4) {
  print(x[i])
}

for(i in seq_along(x)) {
  print(x[i])
}

for(letter in x) {
  print(letter)
}
```


## Nested `for` Loops

Example:

```{r}
x <- matrix(1:6, 2, 3)
for(i in seq_len(nrow(x))) {
          for(j in seq_len(ncol(x))) {
                print(x[i, j])
           }
}

```


## `while`

- While loops begin by testing a condition. 
- If it is true, then they execute the loop body. Once the loop
  body is executed, the condition is tested again, and so forth, until the condition is false,     after which the loop exits.

Example:

```{r}
count <- 0
while(count < 10) {
          print(count)
          count <- count + 1
          }

```

One more `While` example
```{r}
   z <- 5
   set.seed(1)

  while(z >= 3 && z <= 10) {
  coin <- rbinom(1, 1, 0.5)

  if(coin == 1) { ## random walk
                 z <- z + 1
              } else {
          z <- z - 1
         }
 }
 print(z)
```

Conditions are always evaluated from left to right. For example, in the above code, if z were less than 3, the second test would not have been evaluated.

## `repeat`

Example:

```{r}
x0 <- 1
counter<-2
tol <- 1e-3
repeat {
  
  x1 <-(1 - 1/counter)
  if(abs(x1 - x0) < tol) { 
                              break
                        } else {
                           counter<-counter + 1
                          }
}

```


## `break` and `next`

`break` is used to exit a loop immediately, regardless of what iteration the loop may be on.

``next is used to skip an iteration of a loop.


Example:

```{r}
for(i in 1:10) {
             if(i <= 5) {
                         ## Skip the first 5 iterations
                             next
                         }
           print(i)
}
```


## Vectorized Operations


-Many operations in R are vectorized, meaning that operations occur in parallel in certain R      objects.

-This allows you to write code that is efficient, concise, and easier to read than in             non-vectorized languages.

```{r}

x <- 1:4
y <- 6:9
z <- x + y
z

# compare the non-vectorized with for-loop
z <- numeric(length(x))
for(i in seq_along(x)) {
                        z[i] <- x[i] + y[i]
}
z

x<-c(1,2,3,4)
x > 2

```


## Vectorized Matrix Operations



```{r}
x <- matrix(1:4, 2, 2)
y <- matrix(rep(10, 4), 2, 2)

## element-wise multiplication
x * y

## true matrix multiplication
x %*% y


```

